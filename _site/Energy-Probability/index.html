<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Probabilities as Energies; and, Cluster Decomposition of Joint Distributions</title>

  <!-- Tag styling -->
  <style>
    .tags { margin: 0.5em 0 1.5em 0; }
    .tag {
      display: inline-block;
      padding: 2px 8px;
      margin: 2px;
      background: rgba(255,255,255,0.08);
      border-radius: 3px;
      font-size: 0.85em;
      text-decoration: none;
      color: var(--muted);
    }
    .tag:hover { background: rgba(255,255,255,0.15); color: var(--accent); }
  </style>

  <!-- MathJax configuration for LaTeX rendering -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true,
        tags: 'ams'
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        ignoreHtmlClass: "tex2jax_ignore",
        processHtmlClass: "tex2jax_process"
      },
      svg: {
        fontCache: 'global'
      },
      startup: {
        pageReady: function () {
          return MathJax.startup.defaultPageReady().then(function () {
            console.log('MathJax is loaded and ready');
          });
        }
      }
    };
  </script>
  <script type="text/javascript" async src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-svg.js"></script>

  <!-- Site stylesheet -->
  <link rel="stylesheet" href="/crw-blog/assets/css/style.css">
</head>

<body>
  <!-- Header and site title -->
  <header>
    <h1>Fruit of Preterition</h1>
    <nav>
      <ul>
        <li><a href="/crw-blog/">Home</a></li>
        <li><a href="/crw-blog/seeds/">Seeds <span class="wip-badge">WIP</span></a></li>
        <li><a href="/crw-blog/tags/">Tags <span class="wip-badge">WIP</span></a></li>
        <li><a href="/crw-blog/reading/">Reading <span class="wip-badge">WIP</span></a></li>
        <li><a href="/crw-blog/nulla-dies/">Nulla Dies</a></li>
      </ul>
    </nav>
  </header>

  <!-- Main content of the page -->
  <main>
    <div class="site-container">
      <div class="content">
        
        <div class="tags">
          
          <a href="/crw-blog/tags/#math" class="tag">math</a>
          
          <a href="/crw-blog/tags/#information-theory" class="tag">information-theory</a>
          
        </div>
        
        <p>Here I will outline the precise connection between probability and statistical mechanics. This is something I think some people take for granted and others don’t appreciate at all; either way, even after a lot of working in the area, I’ve never seen an explicit correspondence put together in one place. Writing this helped me appreciate some subtleties I wasn’t previously aware of. The biggest one is the role of <strong>cluster decompositions</strong> and <strong>Möbius inversion</strong>: a canonical and fully general way to factorize arbitrary joint distributions into a hierarchy of multi-body interactions.</p>

<p>TLDR: the mainline of statistical physics is literally identical to probability theory just with different letters. This can be shown <strong>without</strong> any approximations or limits. The “thermodynamic limit” is not baked into statistical physics; it’s a technique to make otherwise-impossible probability calculations tractable once you add structural assumptions (locality, extensivity, homogeneity, etc). The bridge is the energy function; the moment generating function in probability is the partition function with sources, and the cumulant generating function is the free energy (up to the usual normalization constant).</p>

<h2 id="approximate-toc">Approximate ToC</h2>

<ol>
  <li><strong>Energy ↔ probability</strong> with β = 1 and ($p = e^{-H}$).</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td><strong>Cluster decomposition</strong>: any joint $p(x_1,\dots,x_N)$ has a canonical decomposition into irreducible (</td>
          <td>S</td>
          <td>)-body interaction terms.</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li><strong>Möbius inversion</strong>: the mechanism that turns “marginal energies” into “connected interaction energies” (and also does the same thing for entropies).</li>
  <li><strong>Maximum entropy inference</strong>: constraints on marginals ↔ keep some interaction terms, set the rest to zero (plus a toy example).</li>
</ol>

<h3 id="an-energy-probability-translation-dictionary">An Energy-Probability Translation Dictionary</h3>

<p>I set $\beta=1$. I’m also going to keep two <em>different</em> energy-like objects around.  We’ll call $H$ any energy function which is normalized, and $V$ anything which is “like an energy” but fails to satisfy some conditions (which will depend what we are talking about).</p>

<p>First: $H$ is equivalent to $p$ - up to normalization (which we’ll assume $H$ obeys just as we do for $p$, though sometimes we want to yoink it out as the free energy),</p>

\[p(x) = e^{-H(x)}\]

\[H(x) = -\log p(x)\]

<p><strong>Normalization Condition</strong></p>

\[\int dx~ e^{-H(x)} = \int dx~p(x) = 1.\]

<p>Again, free energy $F$ is baked into $H$.  Don’t worry - there is a canonical way to get it out, I’ll show you later.  But for now we’ll be a little nonstandard, just for the sake of brevity</p>

<p><strong>With sources</strong> ($J$)</p>

\[Z[J] := \int dx~e^{-H(x) - J\cdot x}, \qquad F[J] := -\log Z[J].\]

<p>(so note that $Z[0]=1$ and $F[0]=0$)
The <em>probability</em> cumulant generating function (CGF) is then the normalized free energy:</p>

\[\psi(J) := \log \mathbb E_p[e^{J\cdot X}] = \log\left(Z[-J]\right) = -F[-J].\]

<p>(the signs are just an annoying convention, morally they’re the same!  I found the other conventions even more annoying, sorry.)</p>

<p><strong>Expectations</strong></p>

\[\mathbb E_p[f(X)] = \int dx~p(x)f(x)=\int dx~e^{-H(x)}f(x).\]

<p><strong>Shannon entropy</strong> (I’m going to use $S$ for entropy as $H$ is taken.  Which sucks because it should be reserved for action, lol):</p>

\[S[p] := -\int dx~p(x)\log p(x) = \mathbb E_H[H].\]

<p>(note we switch freely between $\mathbb E_H$ and $\mathbb E_p$)</p>

<p>We see that entropy ‘is expected energy’ in this convention, because $H=-\log p$.  Neat eh?  More to come.</p>

<p><strong>KL divergence</strong>:</p>

\[D_{KL}(p|q)=\int dx~p(x)\log\frac{p(x)}{q(x)}=\mathbb E_{H_p}[H_q - H_p].\]

<p><strong>Marginalization</strong></p>

\[p(x)=\int dy~p(x,y), \qquad H(x)=-\log\int dy~e^{-H(x,y)}.\]

<p>This is cute for sure, but there actually is something novel and interesting that falls out of this - a canonical decomposition of the energy into a sum over N-body interaction terms.</p>

<h3 id="warm-up-2-variables-the-mutual-information-cameo">Warm-up: 2 variables (the mutual information cameo)</h3>

<p>Let’s inspire ourselves by asking how we might decompose $H$:</p>

\[H(x,y) = H_x(x) + H_y(y) + H_{xy}(x,y).\]

<p>Intuitively, we should probably set $H_x$ and $H_y$ by the marginals $-\log p(x)$ and $-\log p(y)$.  Subtract those out and you’ll find we have:</p>

\[H_{xy}(x,y)=-\log\frac{p(x,y)}{p(x)p(y)}.\]

<p>That is the <strong>pointwise mutual information</strong> (PMI).  Woooah neat, yeah?
“The 2-body interaction energy is the pointwise mutual information!”</p>

<p>Okay cool.  Next I’ll show you how this generalizes, then we’ll talk about Mobius inversions (which are a general tool to derive these sorts of relations - you’ll see)</p>

<h2 id="cluster-decomposition-of-a-joint-distribution">Cluster decomposition of a joint distribution</h2>

<p>Given a joint $p(x_1,\dots,x_N)$, we can write a decomposition  into “local Hamiltonians”</p>

\[H(x_1,\dots,x_N) = \sum_{S\subseteq\{1,\dots,N\}} H_S(x_S),\]

<p>where each $H_S$ encodes the part of the joint that is “irreducibly S” (in physics, we usually have permutation invariance, so we get a bunch of the $H_S$ reduces to something like “$|S|$-body potentials”.</p>

<p>A term looks like</p>

\[H_{1,7,22}(x_1,x_7,x_{22}) = 37x_1^{-2} x_7^{-6} x_{22}^{-4} - \{stuff\}\]

<p>where “stuff” will enforce the “gauge” condition below.  (even powers for no reason except I dislike writing absolute value signs)</p>

<p>This ends up a big decomposition into an obscene number of parts, but it is <em>canonical</em> (once we set the ‘gauge’), and at least highly suggestive of what kinds of approximations one might make - do you really think you <em>should</em> be modeling irreducible 45-body interactions?  Maybe don’t.  Definitely don’t.</p>

<h3 id="set-a-gauge">Set a gauge</h3>

<p>By default you can imagine moving pieces from $H_2$ into $H_{2,95}$, but there is a nice canonical ‘gauge’ condition we can set - 
For every nonempty $S$ and every $i\in S$,</p>

\[\int dx_i~H_S(x_S) = 0 \quad\text{for all fixed } x_{S\setminus\{i\}}.\]

<p>Interpretation: $H_S$ has zero “shadow” on any strict subset; it’s ‘irreducible’ to  $S$.  So the example above would be</p>

\[H_{1,7,22}(x_1,x_7,x_{22}) = 37x_1^{-2} x_7^{-6} x_{22}^{-4} - \{stuff\}\]

\[\{stuff\} = \left[\int dx_1 + \int dx_7 + \int dx_{22} \right](37x_1^{-2} x_7^{-6} x_{22}^{-4})\]

<p>This seems somewhat brutish inclusion-exclusion hackery - and it is, but also it is an instance of something much more general called Mobius inversion!</p>

<p>To come clean, the above condition isn’t complete - think of what you could choose to be added in but which still shouldn’t be included.  Mobius inversion fixes those.  The fastest way to show you is to show you.</p>

<hr />

<h2 id="connected-and-disconnected-möbius-inversion-on-subsets">Connected and disconnected: Möbius Inversion on Subsets</h2>

<p>TLDR for physicists: the thing that generically converts between “connected” and “disconnected” components (of basically anything indexed by subsets) is ‘Möbius inversion’. (This is not the Möbius transform $f(z)=\frac{az+b}{cz+d}$) It’s the ‘inclusion–exclusion’ thing like Venn diagrams but just much more general.</p>

<p>TLDR for mathematicians: go read the wikipedia page, it knows better than me.</p>

<h3 id="the-zeta-transform-and-its-inverse">The ‘zeta transform’ and its inverse</h3>

<p>Let $a(S)$ and $b(S)$ be functions on sets $S$ (== quantities “indexed by S”).  If we define</p>

\[a(S)=\sum_{T\subseteq S} b(T),\]

<p>Mobius inversion is how you back out $b$:</p>

\[b(S)=\sum_{T\subseteq S}\mu(S,T)\,a(T),\]

<p>For the case we care about, which is the “subset lattice” $\mu$ is:</p>

\[\mu(S,T)=(-1)^{|S|-|T|}.\]

<p>Note that this looks a lot like a matrix multiplication!  We can write a nice multiplication notation:
$a = 1 * b$ and $b = \mu * a$ .  Here $1$ is the function $1(S,T)=1$, which lets us write $\mu = (1)^{-1}$, (lol seethe and cope).  In general, the ‘*’ is “Dirichlet convolution”, and ‘1*’ is the ‘zeta transform’.  Afaik, no relation to Herr Riemann’s $\zeta$.  The thing people generalize to is by running the sum over something other than ‘all possible subsets of a given parent’.</p>

<h3 id="apply-it-to-probabilities">Apply it to probabilities</h3>

<p>Let $p_T(x_T)$ be the marginal on $x_T$. Define the marginal log-probability</p>

\[V_T(x_T):=-\log p_T(x_T).\]

<p>Then the irreducible interaction term $E_S$ is given by the Möbius inversion:</p>

\[H_S(x_S) = \sum_{T\subseteq S} (-1)^{|S|-|T|}~V_T(x_T).\]

<p>This is the canonical “cluster decomposition” I promised: you compute marginal energies, then apply inclusion–exclusion to strip off everything explainable by strict subsets.  You can verify by induction that this satisfies the “gauge” condition from before.  It’s just “don’t double count” but fancy: $\mathcal{DON’T~ DOUBLE~-~COUNT}$.</p>

<h3 id="the-same-trick-gives-you-multi-way-information-from-subsystem-entropies">The same trick gives you “multi-way information” from subsystem entropies</h3>

<p>From the Shannon entropy of a marginal distribution $S[p_T]$, the “connected entropy” / “interaction information” / “co-information”, $I(T)$</p>

\[I(T) := \sum_{T'\subseteq T} (-1)^{|T|-|T'|}S(T).\]

<p>(okay yeah didn’t plan far enough ahead when I chose $S$ for entropy.  Sorry lol.)</p>

<h3 id="gauge-fixing">Gauge-fixing</h3>

<p>Stare at the discussion above until you have convinced yourself that the Mobius inversion canonically selects out the localised bits for each $S$ from any $V(x)$, and also note that you can, if feeling cheeky, take $H_{\emptyset} = F$ the free energy.</p>

<hr />

<h2 id="maximum-entropy-inference-the-killer-app">Maximum Entropy Inference (The Killer App)</h2>

<p>Now here’s the thing that gives this meaning beyond the combinatorics.</p>

<p>Consider the MaxEnt problem of inferring a distribution given its marginals:</p>

\[\text{maximize } S[q] \ \ \text{subject to}\ \ q|_{R_i}=p|_{R_i}\ \ \forall i\in\{1,\dots,m\},\]

<p>In the energetic picture, this is clean</p>
<ul>
  <li>Each marginal constraint $q|<em>{R_i}=p|</em>{R_i}$ pins down the marginal energy $E_{R_i}=\log p_{R_i}$
    <ul>
      <li>it also specifies the ‘descendant’ marginals - these have to agree or the problem is infeasible</li>
    </ul>
  </li>
  <li>Use Mobius transform to calculate these energies</li>
  <li>then the optimal $q^*$ is the sum of all energies specified by the constraints (including the descendants, counted only once).</li>
</ul>

<p>So very concretely, with a bit of Occamite flavouring, this means you back out the maximum entropy inferred distribution by taking the energies you know you have to have, and setting the higher order ones to be zero.</p>

<p>Take $\mathcal R$ to be the set of marginals specified, $H_{p,R_i}$, plus also descendants of the $R_i$’s; then</p>

\[H_{q}^* = \sum_{S\subseteq \mathcal R} H_{p,S}\]

<h2 id="a-gibbsian-aside">A Gibbsian Aside</h2>

<p>The Gibbs distribution from which all thermodynamics arises solves</p>

\[\max_p S[p] ~~s.t. ~~ \mathbb E_p[\mathcal O_i] = o_i, \forall i\]

<p>where $i$ labels the constraints on different observables $\mathcal O_i$.  You are doubtless most familiar with the case where there is one constraint, $\mathbb E[H] = U$ ($U$ is the internal energy, $H$ the Hamiltonian / honest-to-god energy), and whose lagrange multiplier is the inverse temperature $\beta$.</p>

<p>I just want to point out how very nice the solution to this problem looks in the energy language.  For 10 seconds I’ll switch to using $E$ for the energy of our distribution (the thing we’re optimizing), so we don’t confuse it with the system’s Hamiltonian, and physical states are $\omega$:</p>

\[E^*(\omega) = F + \sum_i \lambda_i \mathcal O_i(\omega)\]

<p>You can choose to specify either $\lambda_i$ or $o_i$ for each constraint; $F$ depends on the choice of all of them.</p>

<hr />

<h2 id="summary">Summary</h2>

<ul>
  <li>probability distributions can be specified by $p = e^{-H}$ or $H = -\log p$</li>
  <li>Writing things in terms of $H$, large chunks of probability theory can be made identical to statistical mechanics.
    <ul>
      <li>Expected values of energies yield entropies</li>
    </ul>
  </li>
  <li>Any joint energy like $H(x_1,…x_N)$ can be canonically decomposed into energies on subsets of the variables $S$.  This ‘isolates’ dependencies to each subset, maximizing the amount of information accounted for by the smaller subsets and only assigning to larger sets that component of the interaction which cannot be accounted for at a lower level.</li>
  <li>The technique to back out those subset interactions is the Mobius inversion.</li>
  <li>This same decomposition can be applied to information / entropy, which provides a simple way to derive the ‘interaction’ informations.</li>
  <li>Inference of a distribution based on its marginals is simple when written in terms of energies: the marginals specify the interaction potential $H_S$ for for the given set and its own marginals, and the maximum entropy distribution is that which matches the energies specified without adding anything else.</li>
  <li>The energy formulation makes the Gibbs distribution look very nice and affine and pretty.  Reasonably so!</li>
  <li>In defining this decomposition of the energy over subsets, the Mobius inversion can be seen as a gauge-fixing condition.</li>
</ul>

<hr />

<p><em>Edit 17 Jan 2026: After writing this, I’ve learned that much of this theory is subsumed under the name of ‘Hoeffding decomposition’, which in fact applies to more general functions and is used in so-called “U-statistics”.  Hoeffding’s version is also nicer in that it uses the expectation value instead of a raw integral.</em></p>

      </div>
    </div>
  </main>

  <!-- Footer with basic info -->
  <footer>
    <p>&copy; 2026 Fruit of Preterition. Powered by <a href="https://pages.github.com/">GitHub
        Pages</a>.</p>
  </footer>
</body>

</html>